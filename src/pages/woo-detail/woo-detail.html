<ion-header>

  <ion-navbar>
    <ion-title *ngIf="selectedItem?.name"><span [innerHTML]="selectedItem.name"></span></ion-title>

    <ion-buttons end>
		<button ion-button (click)="showCart()" [ngClass]="{ 'item-added' : itemAdded  }">
			<ion-icon name="cart"></ion-icon>
			<ion-badge color="dark" item-end>{{cart_count}}</ion-badge>
		</button>
	</ion-buttons>
  </ion-navbar>

</ion-header>

<ion-content>

 <section *ngIf="selectedItem" class="single-product">

 	<ion-slides pager>

	  <ion-slide *ngFor="let image of selectedItem.images">
	    <img src="{{image.src}}" />
	  </ion-slide>

	</ion-slides>

	<div class="single-product-content">

	    <h2 [innerHTML]="selectedItem.name"></h2>

	    <p *ngIf="selectedItem.price && !selectedItem.sale_price" class="product-price">${{selectedItem.price}}</p>

	    <p *ngIf="!selectedItem.price && !selectedItem.sale_price && selectedItem.price_html" [innerHTML]="selectedItem.price_html"></p>

	    <p *ngIf="selectedItem.sale_price" class="product-price">Sale! ${{selectedItem.sale_price}}</p>

		<div *ngIf="description" [innerHTML]="description"></div>

		<p *ngIf="selectedItem.average_rating != '0.00'" class="product-rating"><em>Rating: {{selectedItem.average_rating}} stars</em></p>

		<p *ngIf="selectedItem.in_stock" class="product-stock">âœ“ In Stock.</p>

		<form (ngSubmit)="addToCart(addToCartForm)" #addToCartForm="ngForm">

			<div *ngIf="variations">
				<ion-item *ngIf="variations.length">
					<ion-label stacked>Options</ion-label>
					<ion-select ngModel name="variation_id">
						<ion-option *ngFor="let variation of variations" value="{{variation.id}}">
							${{variation.price}} - 
							<div *ngFor="let attr of variation.attributes">
								{{attr.name}} : {{attr.option}}
							</div>
						</ion-option>
					</ion-select>
				</ion-item>
			</div>
			
			<div *ngIf="groupedProducts?.length">
				<ion-grid *ngFor="let groupProd of groupedProducts">
					<ion-row class="grouped-product">
						<ion-col col-6>
							<span class="product-name">{{groupProd.name}}</span>
						</ion-col>
						<ion-col col-3>
							<span class="product-price" [innerHTML]="groupProd.price_html"></span>
						</ion-col>
						<ion-col col-3 text-center class="product-quantity">
							<ion-icon item-start name="remove-circle" (click)="decrement( groupProd )"></ion-icon>
							<span>{{ groupProd.quantity }}</span>
							<ion-icon item-end name="add-circle" (click)="increment( groupProd )"></ion-icon>
						</ion-col>
					</ion-row>
					<ion-input type="hidden" ngModel name="{{groupProd.id}}"></ion-input>
				</ion-grid>
			</div>

			<ion-item class="product-quantity" *ngIf="!groupedProducts?.length && productLoaded">
				<ion-label>{{ selectedItem.quantity }}</ion-label>
				<ion-icon item-start name="remove-circle" (click)="decrement( selectedItem )"></ion-icon>
				
				<ion-icon item-end name="add-circle" (click)="increment( selectedItem )"></ion-icon>
			</ion-item>
			
			<button *ngIf="productLoaded" ion-button type="submit" block>Add to Cart</button>

		</form>
	</div>
 </section>
</ion-content>
